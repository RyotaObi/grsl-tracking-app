{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/admin/Documents/my-app/lib/utils/simplify-route.ts"],"sourcesContent":["// Douglas-Peucker アルゴリズムを使用してルートを簡略化\r\nexport function simplifyRoute(\r\n  points: { lat: number; lng: number }[],\r\n  tolerance = 0.0001,\r\n): { lat: number; lng: number }[] {\r\n  if (points.length <= 2) {\r\n    return points\r\n  }\r\n\r\n  // 最初と最後のポイントを結ぶ線からの最大距離を持つポイントを見つける\r\n  let maxDistance = 0\r\n  let maxIndex = 0\r\n  const start = points[0]\r\n  const end = points[points.length - 1]\r\n\r\n  for (let i = 1; i < points.length - 1; i++) {\r\n    const distance = perpendicularDistance(points[i], start, end)\r\n    if (distance > maxDistance) {\r\n      maxDistance = distance\r\n      maxIndex = i\r\n    }\r\n  }\r\n\r\n  // 最大距離がtoleranceより大きい場合、再帰的に分割\r\n  if (maxDistance > tolerance) {\r\n    const left = simplifyRoute(points.slice(0, maxIndex + 1), tolerance)\r\n    const right = simplifyRoute(points.slice(maxIndex), tolerance)\r\n\r\n    // 結合（中間のポイントを重複させないため、leftの最後を除く）\r\n    return [...left.slice(0, -1), ...right]\r\n  } else {\r\n    // toleranceより小さい場合、最初と最後のポイントだけを返す\r\n    return [start, end]\r\n  }\r\n}\r\n\r\n// ポイントから線分への垂直距離を計算\r\nfunction perpendicularDistance(\r\n  point: { lat: number; lng: number },\r\n  lineStart: { lat: number; lng: number },\r\n  lineEnd: { lat: number; lng: number },\r\n): number {\r\n  const x = point.lng\r\n  const y = point.lat\r\n  const x1 = lineStart.lng\r\n  const y1 = lineStart.lat\r\n  const x2 = lineEnd.lng\r\n  const y2 = lineEnd.lat\r\n\r\n  const A = x - x1\r\n  const B = y - y1\r\n  const C = x2 - x1\r\n  const D = y2 - y1\r\n\r\n  const dot = A * C + B * D\r\n  const lenSq = C * C + D * D\r\n\r\n  let param = -1\r\n  if (lenSq !== 0) {\r\n    param = dot / lenSq\r\n  }\r\n\r\n  let xx, yy\r\n\r\n  if (param < 0) {\r\n    xx = x1\r\n    yy = y1\r\n  } else if (param > 1) {\r\n    xx = x2\r\n    yy = y2\r\n  } else {\r\n    xx = x1 + param * C\r\n    yy = y1 + param * D\r\n  }\r\n\r\n  const dx = x - xx\r\n  const dy = y - yy\r\n\r\n  return Math.sqrt(dx * dx + dy * dy)\r\n}\r\n\r\n// 重複ポイントを削除（GPSの精度による微小な揺れを除去）\r\nexport function removeDuplicatePoints(\r\n  points: { lat: number; lng: number }[],\r\n  minDistance = 0.00001, // 約1メートル\r\n): { lat: number; lng: number }[] {\r\n  if (points.length <= 1) {\r\n    return points\r\n  }\r\n\r\n  const result: { lat: number; lng: number }[] = [points[0]]\r\n\r\n  for (let i = 1; i < points.length; i++) {\r\n    const prev = result[result.length - 1]\r\n    const curr = points[i]\r\n\r\n    const distance = Math.sqrt(Math.pow(curr.lat - prev.lat, 2) + Math.pow(curr.lng - prev.lng, 2))\r\n\r\n    if (distance >= minDistance) {\r\n      result.push(curr)\r\n    }\r\n  }\r\n\r\n  return result\r\n}\r\n\r\nexport async function snapToRoads(\r\n  points: { lat: number; lng: number }[],\r\n): Promise<{ lat: number; lng: number }[] | null> {\r\n  try {\r\n    // OSRM has a limit of 100 points per request\r\n    // First simplify to reduce points if necessary\r\n    let processedPoints = points\r\n    if (points.length > 100) {\r\n      processedPoints = simplifyRoute(points, 0.0002) // More aggressive simplification\r\n      console.log(`[v0] Reduced points for OSRM: ${points.length} → ${processedPoints.length}`)\r\n    }\r\n\r\n    // Format coordinates for OSRM: \"lng,lat;lng,lat;...\"\r\n    const coordinates = processedPoints.map((p) => `${p.lng},${p.lat}`).join(\";\")\r\n\r\n    // Call OSRM Map Matching API\r\n    const url = `https://router.project-osrm.org/match/v1/driving/${coordinates}?overview=full&geometries=geojson`\r\n\r\n    console.log(`[v0] Calling OSRM Map Matching API with ${processedPoints.length} points...`)\r\n\r\n    const response = await fetch(url)\r\n    if (!response.ok) {\r\n      throw new Error(`OSRM API error: ${response.status}`)\r\n    }\r\n\r\n    const data = await response.json()\r\n\r\n    if (data.code !== \"Ok\" || !data.matchings || data.matchings.length === 0) {\r\n      console.error(\"[v0] OSRM matching failed:\", data.message)\r\n      return null\r\n    }\r\n\r\n    // Extract matched coordinates\r\n    const matchedCoordinates = data.matchings[0].geometry.coordinates.map((coord: [number, number]) => ({\r\n      lng: coord[0],\r\n      lat: coord[1],\r\n    }))\r\n\r\n    console.log(`[v0] OSRM Map Matching successful: ${processedPoints.length} → ${matchedCoordinates.length} points`)\r\n\r\n    return matchedCoordinates\r\n  } catch (error) {\r\n    console.error(\"[v0] Error in road snapping:\", error)\r\n    return null\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 249, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/admin/Documents/my-app/lib/firebase.ts"],"sourcesContent":["import { initializeApp, getApps } from \"firebase/app\"\r\nimport {\r\n  getFirestore,\r\n  collection,\r\n  query,\r\n  orderBy,\r\n  onSnapshot,\r\n  Timestamp,\r\n  doc,\r\n  getDoc,\r\n  getDocs,\r\n  setDoc,\r\n} from \"firebase/firestore\"\r\nimport type { LocationData, SavedRoute, ActiveRouteSettings, DaySchedule, MonthSchedule } from \"./types\"\r\nimport { simplifyRoute, removeDuplicatePoints, snapToRoads } from \"./utils/simplify-route\"\r\n\r\nconst firebaseConfig = {\r\n  apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\r\n  authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\r\n  projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\r\n  storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\r\n  messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\r\n  appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\r\n  measurementId: process.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID,\r\n}\r\n\r\n// Initialize Firebase (singleton pattern)\r\nconst app = getApps().length === 0 ? initializeApp(firebaseConfig) : getApps()[0]\r\nconst db = getFirestore(app)\r\n\r\nexport { app, db }\r\n\r\nexport function getRealtimeLocations(\r\n  collectionName: string,\r\n  callback: (locations: LocationData[]) => void,\r\n): () => void {\r\n  const locationsRef = collection(db, collectionName)\r\n  const q = query(locationsRef, orderBy(\"timestamp\", \"asc\"))\r\n\r\n  const unsubscribe = onSnapshot(\r\n    q,\r\n    (snapshot) => {\r\n      const locations: LocationData[] = []\r\n      snapshot.forEach((doc) => {\r\n        const data = doc.data()\r\n        locations.push({\r\n          id: doc.id,\r\n          latitude: data.latitude,\r\n          longitude: data.longitude,\r\n          timestamp: data.timestamp instanceof Timestamp ? data.timestamp.toDate() : new Date(data.timestamp),\r\n          speed: data.speed,\r\n          accuracy: data.accuracy,\r\n        })\r\n      })\r\n      callback(locations)\r\n    },\r\n    (error) => {\r\n      console.error(\"[v0] Firestore error:\", error)\r\n    },\r\n  )\r\n\r\n  return unsubscribe\r\n}\r\n\r\nexport async function getActiveRoute(): Promise<string | null> {\r\n  try {\r\n    const docRef = doc(db, \"settings\", \"active-route\")\r\n    const docSnap = await getDoc(docRef)\r\n\r\n    if (docSnap.exists()) {\r\n      const data = docSnap.data() as ActiveRouteSettings\r\n      return data.routeId\r\n    }\r\n    return null\r\n  } catch (error) {\r\n    console.error(\"[v0] Error getting active route:\", error)\r\n    return null\r\n  }\r\n}\r\n\r\nexport async function getSavedRoute(routeId: string): Promise<SavedRoute | null> {\r\n  try {\r\n    const docRef = doc(db, \"saved-routes\", routeId)\r\n    const docSnap = await getDoc(docRef)\r\n\r\n    if (docSnap.exists()) {\r\n      return docSnap.data() as SavedRoute\r\n    }\r\n    return null\r\n  } catch (error) {\r\n    console.error(\"[v0] Error getting saved route:\", error)\r\n    return null\r\n  }\r\n}\r\n\r\nexport async function getSavedRoutes(): Promise<{ id: string; name: string; pointCount: number }[]> {\r\n  try {\r\n    const routesRef = collection(db, \"saved-routes\")\r\n    const snapshot = await getDocs(routesRef)\r\n    return snapshot.docs.map((docSnap) => {\r\n      const data = docSnap.data() as SavedRoute\r\n      return {\r\n        id: docSnap.id,\r\n        name: data.name || docSnap.id,\r\n        pointCount: data.points?.length || 0,\r\n      }\r\n    })\r\n  } catch (error) {\r\n    console.error(\"[v0] Error listing saved routes:\", error)\r\n    return []\r\n  }\r\n}\r\n\r\nexport async function getDateCollections(): Promise<string[]> {\r\n  try {\r\n    const docRef = doc(db, \"date-index\", \"dates\")\r\n    const docSnap = await getDoc(docRef)\r\n\r\n    if (docSnap.exists()) {\r\n      const data = docSnap.data()\r\n      const dateList = data.dateList as string[]\r\n\r\n      // Sort by date descending (newest first)\r\n      return dateList.sort((a, b) => {\r\n        const dateA = a.split(\"_\")[0]\r\n        const dateB = b.split(\"_\")[0]\r\n        return dateB.localeCompare(dateA)\r\n      })\r\n    }\r\n\r\n    return []\r\n  } catch (error) {\r\n    console.error(\"[v0] Error getting date index:\", error)\r\n    return []\r\n  }\r\n}\r\n\r\nexport async function getAllLocationsFromCollection(collectionName: string): Promise<LocationData[]> {\r\n  try {\r\n    const locationsRef = collection(db, collectionName)\r\n    const q = query(locationsRef, orderBy(\"timestamp\", \"asc\"))\r\n    const snapshot = await getDocs(q)\r\n\r\n    const locations: LocationData[] = []\r\n    snapshot.forEach((doc) => {\r\n      const data = doc.data()\r\n      locations.push({\r\n        id: doc.id,\r\n        latitude: data.latitude,\r\n        longitude: data.longitude,\r\n        timestamp: data.timestamp instanceof Timestamp ? data.timestamp.toDate() : new Date(data.timestamp),\r\n        speed: data.speed,\r\n        accuracy: data.accuracy,\r\n      })\r\n    })\r\n\r\n    return locations\r\n  } catch (error) {\r\n    console.error(\"[v0] Error getting locations from collection:\", error)\r\n    return []\r\n  }\r\n}\r\n\r\nexport async function saveRouteAsActive(routeId: string, locations: LocationData[]): Promise<boolean> {\r\n  try {\r\n    const points = locations.map((loc) => ({\r\n      lat: loc.latitude,\r\n      lng: loc.longitude,\r\n      timestamp: loc.timestamp instanceof Date ? loc.timestamp.toISOString() : loc.timestamp,\r\n    }))\r\n\r\n    const deduplicated = removeDuplicatePoints(points)\r\n    console.log(`[v0] Step 1 - Deduplication: ${points.length} → ${deduplicated.length} points`)\r\n\r\n    const snapped = await snapToRoads(deduplicated)\r\n\r\n    let finalPoints: { lat: number; lng: number }[]\r\n\r\n    if (snapped) {\r\n      console.log(`[v0] Step 2 - Road snapping successful: ${snapped.length} points`)\r\n      finalPoints = snapped\r\n    } else {\r\n      console.log(\"[v0] Step 2 - Road snapping failed, using Douglas-Peucker instead\")\r\n      const simplified = simplifyRoute(deduplicated, 0.0001)\r\n      console.log(`[v0] Step 2 - Simplification: ${deduplicated.length} → ${simplified.length} points`)\r\n      finalPoints = simplified\r\n    }\r\n\r\n    // Save route data to /saved-routes/{routeId}\r\n    const routeDocRef = doc(db, \"saved-routes\", routeId)\r\n    const savedRoute: SavedRoute = {\r\n      name: `${routeId}のルート`,\r\n      createdAt: new Date().toISOString(),\r\n      points: finalPoints,\r\n    }\r\n    await setDoc(routeDocRef, savedRoute)\r\n\r\n    // Update /settings/active-route to point to this route\r\n    const settingsDocRef = doc(db, \"settings\", \"active-route\")\r\n    const activeSettings: ActiveRouteSettings = {\r\n      routeId: routeId,\r\n      updatedAt: new Date().toISOString(),\r\n    }\r\n    await setDoc(settingsDocRef, activeSettings)\r\n\r\n    return true\r\n  } catch (error) {\r\n    console.error(\"[v0] Error saving route:\", error)\r\n    return false\r\n  }\r\n}\r\n\r\nexport async function saveCustomRoute(\r\n  routeId: string,\r\n  points: [number, number][],\r\n  options?: { name?: string },\r\n): Promise<boolean> {\r\n  try {\r\n    const routeDocRef = doc(db, \"saved-routes\", routeId)\r\n    const savedRoute: SavedRoute = {\r\n      name: options?.name || `${routeId}のルート`,\r\n      createdAt: new Date().toISOString(),\r\n      points: points.map(([lat, lng]) => ({ lat, lng })),\r\n    }\r\n    await setDoc(routeDocRef, savedRoute)\r\n    return true\r\n  } catch (error) {\r\n    console.error(\"[v0] Error saving custom route:\", error)\r\n    return false\r\n  }\r\n}\r\n\r\nexport async function saveMonthSchedule(yearMonth: string, schedule: MonthSchedule): Promise<boolean> {\r\n  try {\r\n    const docRef = doc(db, \"schedules\", yearMonth)\r\n    await setDoc(docRef, {\r\n      yearMonth,\r\n      days: schedule,\r\n      updatedAt: new Date().toISOString(),\r\n    })\r\n    return true\r\n  } catch (error) {\r\n    console.error(\"[v0] Error saving schedule:\", error)\r\n    return false\r\n  }\r\n}\r\n\r\nexport async function getMonthSchedule(yearMonth: string): Promise<MonthSchedule | null> {\r\n  try {\r\n    const docRef = doc(db, \"schedules\", yearMonth)\r\n    const docSnap = await getDoc(docRef)\r\n\r\n    if (docSnap.exists()) {\r\n      const data = docSnap.data()\r\n      const schedule = data.days as MonthSchedule\r\n      // 後方互換性: 単一のDayScheduleを配列に変換\r\n      const normalized: MonthSchedule = {}\r\n      for (const [dateStr, daySchedule] of Object.entries(schedule)) {\r\n        if (Array.isArray(daySchedule)) {\r\n          normalized[dateStr] = daySchedule\r\n        } else {\r\n          normalized[dateStr] = [daySchedule]\r\n        }\r\n      }\r\n      return normalized\r\n    }\r\n    return null\r\n  } catch (error) {\r\n    console.error(\"[v0] Error getting schedule:\", error)\r\n    return null\r\n  }\r\n}\r\n\r\nexport async function getCurrentScheduleStatus(): Promise<{\r\n  isOperating: boolean\r\n  schedule: DaySchedule | null\r\n  nextOperation?: {\r\n    date: string\r\n    dayOfWeek: string\r\n    startTime: string\r\n    endTime: string\r\n    startLocation: string\r\n  }\r\n} | null> {\r\n  try {\r\n    const now = new Date()\r\n    const yearMonth = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, \"0\")}`\r\n    const dateStr = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, \"0\")}-${String(now.getDate()).padStart(2, \"0\")}`\r\n\r\n    const schedule = await getMonthSchedule(yearMonth)\r\n    if (!schedule || !schedule[dateStr]) {\r\n      const nextOp = await findNextOperation(now)\r\n      return { isOperating: false, schedule: null, nextOperation: nextOp }\r\n    }\r\n\r\n    const daySchedules = Array.isArray(schedule[dateStr]) ? schedule[dateStr] : [schedule[dateStr]]\r\n    const currentTime = `${String(now.getHours()).padStart(2, \"0\")}:${String(now.getMinutes()).padStart(2, \"0\")}`\r\n\r\n    // 現在の時間に該当するスケジュールを探す\r\n    const activeSchedule = daySchedules.find(\r\n      (s) => s.isOperating && currentTime >= s.startTime && currentTime <= s.endTime,\r\n    )\r\n\r\n    if (activeSchedule) {\r\n      return { isOperating: true, schedule: activeSchedule }\r\n    }\r\n\r\n    // 運行中ではない場合、次回の運行を探す\r\n    const nextOp = await findNextOperation(now)\r\n    return { isOperating: false, schedule: daySchedules[0] || null, nextOperation: nextOp }\r\n  } catch (error) {\r\n    console.error(\"[v0] Error getting current schedule status:\", error)\r\n    return null\r\n  }\r\n}\r\n\r\nasync function findNextOperation(fromDate: Date): Promise<\r\n  | {\r\n      date: string\r\n      dayOfWeek: string\r\n      startTime: string\r\n      endTime: string\r\n      startLocation: string\r\n    }\r\n  | undefined\r\n> {\r\n  try {\r\n    const dayNames = [\"日\", \"月\", \"火\", \"水\", \"木\", \"金\", \"土\"]\r\n\r\n    // 今日から30日後まで検索\r\n    for (let i = 0; i < 30; i++) {\r\n      const checkDate = new Date(fromDate)\r\n      checkDate.setDate(checkDate.getDate() + i)\r\n\r\n      const yearMonth = `${checkDate.getFullYear()}-${String(checkDate.getMonth() + 1).padStart(2, \"0\")}`\r\n      const dateStr = `${checkDate.getFullYear()}-${String(checkDate.getMonth() + 1).padStart(2, \"0\")}-${String(checkDate.getDate()).padStart(2, \"0\")}`\r\n\r\n      const schedule = await getMonthSchedule(yearMonth)\r\n      if (!schedule || !schedule[dateStr]) continue\r\n\r\n      const daySchedules = Array.isArray(schedule[dateStr]) ? schedule[dateStr] : [schedule[dateStr]]\r\n      const operatingSchedules = daySchedules.filter((s) => s.isOperating)\r\n\r\n      if (operatingSchedules.length === 0) continue\r\n\r\n      const currentTime = `${String(fromDate.getHours()).padStart(2, \"0\")}:${String(fromDate.getMinutes()).padStart(2, \"0\")}`\r\n\r\n      // 同日の場合は、運行開始時刻が現在時刻より後のスケジュールを探す\r\n      if (i === 0) {\r\n        const futureSchedules = operatingSchedules.filter((s) => s.startTime > currentTime)\r\n        if (futureSchedules.length > 0) {\r\n          // 最も近い未来のスケジュールを選択\r\n          const nextSchedule = futureSchedules.sort((a, b) => a.startTime.localeCompare(b.startTime))[0]\r\n          return {\r\n            date: `${checkDate.getMonth() + 1}/${checkDate.getDate()}`,\r\n            dayOfWeek: dayNames[checkDate.getDay()],\r\n            startTime: nextSchedule.startTime,\r\n            endTime: nextSchedule.endTime,\r\n            startLocation: nextSchedule.startLocation || \"ヤンマー前\",\r\n          }\r\n        }\r\n        // 今日の運行時間は過ぎているので次の日を探す\r\n        continue\r\n      }\r\n\r\n      // 他の日の場合は、最初のスケジュールを返す\r\n      const firstSchedule = operatingSchedules.sort((a, b) => a.startTime.localeCompare(b.startTime))[0]\r\n      return {\r\n        date: `${checkDate.getMonth() + 1}/${checkDate.getDate()}`,\r\n        dayOfWeek: dayNames[checkDate.getDay()],\r\n        startTime: firstSchedule.startTime,\r\n        endTime: firstSchedule.endTime,\r\n        startLocation: firstSchedule.startLocation || \"ヤンマー前\",\r\n      }\r\n    }\r\n\r\n    return undefined\r\n  } catch (error) {\r\n    console.error(\"[v0] Error finding next operation:\", error)\r\n    return undefined\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 605, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/admin/Documents/my-app/app/operator/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect, useMemo } from \"react\"\nimport { ChevronLeft, ChevronRight, Clock, Route, Save, MapPin } from \"lucide-react\"\nimport { useRouter, useSearchParams } from \"next/navigation\"\nimport { saveMonthSchedule, getMonthSchedule, getDateCollections } from \"@/lib/firebase\"\nimport type { DaySchedule, MonthSchedule } from \"@/lib/types\"\n\nconst DRAFT_STORAGE_KEY = \"operatorScheduleDraft\"\n\nexport default function OperatorHome() {\n  const router = useRouter()\n  const searchParams = useSearchParams()\n  const draftFromStorage = useMemo(() => {\n    if (typeof window === \"undefined\") return null\n    const stored = sessionStorage.getItem(DRAFT_STORAGE_KEY)\n    if (!stored) return null\n    sessionStorage.removeItem(DRAFT_STORAGE_KEY)\n    try {\n      return JSON.parse(stored) as {\n        selectedMonth?: string\n        selectedDate?: string | null\n        schedules?: MonthSchedule\n      }\n    } catch {\n      return null\n    }\n  }, [])\n  const [selectedMonth, setSelectedMonth] = useState(\n    draftFromStorage?.selectedMonth ? new Date(draftFromStorage.selectedMonth) : new Date(),\n  )\n  const [schedules, setSchedules] = useState<MonthSchedule>(draftFromStorage?.schedules ?? {})\n  const [selectedDate, setSelectedDate] = useState<string | null>(draftFromStorage?.selectedDate ?? null)\n  const [saving, setSaving] = useState(false)\n  const [message, setMessage] = useState(\"\")\n  const [availableRoutes, setAvailableRoutes] = useState<string[]>([])\n  const [scheduleLoaded, setScheduleLoaded] = useState(false)\n  const [hasDraft, setHasDraft] = useState(Boolean(draftFromStorage))\n\n  useEffect(() => {\n    loadSchedule()\n    loadAvailableRoutes()\n  }, [selectedMonth])\n\n  useEffect(() => {\n    const selectedRouteId = searchParams.get(\"selectedRoute\")\n    const dateParam = searchParams.get(\"date\")\n    const scheduleIndexParam = searchParams.get(\"scheduleIndex\")\n    if (!scheduleLoaded) return\n\n    if (selectedRouteId && dateParam) {\n      const scheduleIndex = scheduleIndexParam ? parseInt(scheduleIndexParam, 10) : 0\n      updateSchedule(dateParam, scheduleIndex, { routeId: selectedRouteId })\n\n      setSelectedDate(dateParam)\n      if (typeof window !== \"undefined\") {\n        const url = new URL(window.location.href)\n        url.searchParams.delete(\"selectedRoute\")\n        url.searchParams.delete(\"date\")\n        url.searchParams.delete(\"scheduleIndex\")\n        window.history.replaceState({}, \"\", url.pathname)\n      }\n\n      setMessage(`ルート ${selectedRouteId} を選択しました。保存ボタンを押してください。`)\n      setTimeout(() => setMessage(\"\"), 5000)\n    }\n  }, [searchParams, scheduleLoaded])\n\n  async function loadSchedule(force = false) {\n    setScheduleLoaded(false)\n    if (hasDraft && !force) {\n      setScheduleLoaded(true)\n      setHasDraft(false)\n      return\n    }\n    const yearMonth = `${selectedMonth.getFullYear()}-${String(selectedMonth.getMonth() + 1).padStart(2, \"0\")}`\n    const schedule = await getMonthSchedule(yearMonth)\n    if (schedule) {\n      setSchedules(schedule)\n    } else {\n      setSchedules({})\n    }\n    setScheduleLoaded(true)\n  }\n\n  async function loadAvailableRoutes() {\n    const routes = await getDateCollections()\n    setAvailableRoutes(routes)\n  }\n\n  async function handleSaveSchedule() {\n    setSaving(true)\n    setMessage(\"\")\n\n    const yearMonth = `${selectedMonth.getFullYear()}-${String(selectedMonth.getMonth() + 1).padStart(2, \"0\")}`\n    const success = await saveMonthSchedule(yearMonth, schedules)\n\n    if (success) {\n      setMessage(\"スケジュールを保存しました\")\n      setHasDraft(false)\n      if (typeof window !== \"undefined\") {\n        sessionStorage.removeItem(DRAFT_STORAGE_KEY)\n      }\n      await loadSchedule(true)\n    } else {\n      setMessage(\"保存に失敗しました\")\n    }\n\n    setSaving(false)\n    setTimeout(() => setMessage(\"\"), 3000)\n  }\n\n  function getDaysInMonth(date: Date) {\n    const year = date.getFullYear()\n    const month = date.getMonth()\n    const firstDay = new Date(year, month, 1)\n    const lastDay = new Date(year, month + 1, 0)\n    const days = []\n\n    for (let day = 1; day <= lastDay.getDate(); day++) {\n      const dateStr = `${year}-${String(month + 1).padStart(2, \"0\")}-${String(day).padStart(2, \"0\")}`\n      days.push({ day, dateStr })\n    }\n\n    return { days, firstDayOfWeek: firstDay.getDay() }\n  }\n\n  const { days, firstDayOfWeek } = getDaysInMonth(selectedMonth)\n\n  function handlePreviousMonth() {\n    setSelectedMonth(new Date(selectedMonth.getFullYear(), selectedMonth.getMonth() - 1))\n    setSelectedDate(null)\n  }\n\n  function handleNextMonth() {\n    setSelectedMonth(new Date(selectedMonth.getFullYear(), selectedMonth.getMonth() + 1))\n    setSelectedDate(null)\n  }\n\n  function handleDayClick(dateStr: string) {\n    setSelectedDate(dateStr)\n  }\n\n  // 日付文字列からスケジュール配列を取得するヘルパー関数\n  function getDaySchedules(dateStr: string): DaySchedule[] {\n    const daySchedule = schedules[dateStr]\n    if (!daySchedule) return []\n    return Array.isArray(daySchedule) ? daySchedule : [daySchedule]\n  }\n\n  // 日付文字列にスケジュール配列を設定するヘルパー関数\n  function setDaySchedules(dateStr: string, daySchedules: DaySchedule[]) {\n    setSchedules((prev: MonthSchedule) => {\n      const updated = { ...prev }\n      if (daySchedules.length > 0) {\n        updated[dateStr] = daySchedules\n      } else {\n        delete updated[dateStr]\n      }\n      return updated\n    })\n  }\n\n  // 特定のインデックスのスケジュールを更新\n  function updateSchedule(dateStr: string, scheduleIndex: number, updates: Partial<DaySchedule>) {\n    const daySchedules = getDaySchedules(dateStr)\n    if (scheduleIndex < 0 || scheduleIndex >= daySchedules.length) return\n\n    const updated = [...daySchedules]\n    updated[scheduleIndex] = { ...updated[scheduleIndex], ...updates }\n    setDaySchedules(dateStr, updated)\n  }\n\n  // 新しいスケジュールを追加\n  function addNewSchedule(dateStr: string) {\n    const newSchedule: DaySchedule = {\n      isOperating: true,\n      startTime: \"10:00\",\n      endTime: \"11:30\",\n      routeType: \"循環ルート\",\n      routeId: \"循環ルート1\",\n      startLocation: \"ヤンマー前\",\n    }\n    const daySchedules = getDaySchedules(dateStr)\n    setDaySchedules(dateStr, [...daySchedules, newSchedule])\n  }\n\n  // スケジュールを削除\n  function removeSchedule(dateStr: string, scheduleIndex: number) {\n    const daySchedules = getDaySchedules(dateStr)\n    if (scheduleIndex < 0 || scheduleIndex >= daySchedules.length) return\n\n    const updated = daySchedules.filter((_, i) => i !== scheduleIndex)\n    setDaySchedules(dateStr, updated)\n  }\n\n  function persistScheduleDraft() {\n    if (typeof window === \"undefined\") return\n    const payload = {\n      selectedMonth: selectedMonth.toISOString(),\n      selectedDate,\n      schedules,\n    }\n    sessionStorage.setItem(DRAFT_STORAGE_KEY, JSON.stringify(payload))\n  }\n\n  function handleSelectRouteFromMap(scheduleIndex: number = 0) {\n    if (!selectedDate) return\n    persistScheduleDraft()\n    router.push(`/operator/route?selectMode=true&date=${selectedDate}&scheduleIndex=${scheduleIndex}`)\n  }\n\n  const monthName = selectedMonth.toLocaleDateString(\"ja-JP\", { year: \"numeric\", month: \"long\" })\n  const selectedDaySchedules = selectedDate ? getDaySchedules(selectedDate) : []\n\n  return (\n    <div style={{ width: \"100%\", height: \"100%\", backgroundColor: \"#f3f4f6\", overflowY: \"auto\", padding: 16 }}>\n      <div style={{ maxWidth: 900, margin: \"0 auto\" }}>\n        <div\n          style={{\n            backgroundColor: \"white\",\n            borderRadius: 16,\n            padding: 24,\n            marginBottom: 16,\n            boxShadow: \"0 1px 3px 0 rgba(0, 0, 0, 0.1)\",\n          }}\n        >\n          <div>\n            <h1 style={{ fontSize: 24, fontWeight: 700, color: \"#1f2937\", marginBottom: 8 }}>スケジュール設定</h1>\n            <p style={{ color: \"#6b7280\", fontSize: 14 }}>\n              カレンダーから日付を選択して、運行スケジュールを設定してください\n            </p>\n          </div>\n        </div>\n\n        {message && (\n          <div\n            style={{\n              backgroundColor: \"rgba(16, 185, 129, 0.1)\",\n              border: \"1px solid #10b981\",\n              color: \"#065f46\",\n              padding: \"12px 16px\",\n              borderRadius: 8,\n              marginBottom: 16,\n              fontSize: 14,\n              fontWeight: 600,\n            }}\n          >\n            {message}\n          </div>\n        )}\n\n        <div\n          style={{\n            backgroundColor: \"white\",\n            borderRadius: 16,\n            padding: \"16px\",\n            marginBottom: 16,\n            boxShadow: \"0 1px 3px 0 rgba(0, 0, 0, 0.1)\",\n          }}\n        >\n          <div style={{ display: \"flex\", alignItems: \"center\", justifyContent: \"space-between\", marginBottom: 16 }}>\n            <button\n              onClick={handlePreviousMonth}\n              style={{\n                width: 36,\n                height: 36,\n                borderRadius: 8,\n                border: \"1px solid #e5e7eb\",\n                backgroundColor: \"white\",\n                cursor: \"pointer\",\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n              }}\n            >\n              <ChevronLeft size={20} />\n            </button>\n            <h2 style={{ fontSize: 18, fontWeight: 700, color: \"#1f2937\" }}>{monthName}</h2>\n            <button\n              onClick={handleNextMonth}\n              style={{\n                width: 36,\n                height: 36,\n                borderRadius: 8,\n                border: \"1px solid #e5e7eb\",\n                backgroundColor: \"white\",\n                cursor: \"pointer\",\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n              }}\n            >\n              <ChevronRight size={20} />\n            </button>\n          </div>\n\n          <div style={{ display: \"grid\", gridTemplateColumns: \"repeat(7, 1fr)\", gap: 4, marginBottom: 4 }}>\n            {[\"日\", \"月\", \"火\", \"水\", \"木\", \"金\", \"土\"].map((day, index) => (\n              <div\n                key={day}\n                style={{\n                  textAlign: \"center\",\n                  fontSize: 11,\n                  fontWeight: 600,\n                  color: index === 0 ? \"#ef4444\" : index === 6 ? \"#3b82f6\" : \"#6b7280\",\n                  padding: 4,\n                }}\n              >\n                {day}\n              </div>\n            ))}\n          </div>\n\n          <div style={{ display: \"grid\", gridTemplateColumns: \"repeat(7, 1fr)\", gap: 4 }}>\n            {Array.from({ length: firstDayOfWeek }).map((_, index) => (\n              <div key={`empty-${index}`} />\n            ))}\n\n            {days.map(({ day, dateStr }) => {\n              const daySchedules = getDaySchedules(dateStr)\n              const isOperating = daySchedules.some((s) => s.isOperating)\n              const isSelected = selectedDate === dateStr\n              const scheduleCount = daySchedules.length\n\n              return (\n                <button\n                  key={dateStr}\n                  onClick={() => handleDayClick(dateStr)}\n                  style={{\n                    aspectRatio: \"1\",\n                    borderRadius: 8,\n                    border: isSelected ? \"2px solid #3b82f6\" : \"1px solid #e5e7eb\",\n                    backgroundColor: isOperating ? \"#dbeafe\" : \"white\",\n                    cursor: \"pointer\",\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    alignItems: \"center\",\n                    justifyContent: \"center\",\n                    padding: 4,\n                    position: \"relative\",\n                    transition: \"all 0.2s\",\n                  }}\n                >\n                  <div style={{ fontSize: 25, fontWeight: 600, color: isOperating ? \"#1e40af\" : \"#1f2937\" }}>{day}</div>\n                  {scheduleCount > 1 && (\n                    <div\n                      style={{\n                        position: \"absolute\",\n                        top: 2,\n                        right: 2,\n                        backgroundColor: \"#3b82f6\",\n                        color: \"white\",\n                        borderRadius: \"50%\",\n                        width: 18,\n                        height: 18,\n                        fontSize: 10,\n                        fontWeight: 700,\n                        display: \"flex\",\n                        alignItems: \"center\",\n                        justifyContent: \"center\",\n                      }}\n                    >\n                      {scheduleCount}\n                    </div>\n                  )}\n                </button>\n              )\n            })}\n          </div>\n        </div>\n\n        {selectedDate && (\n          <div\n            style={{\n              backgroundColor: \"white\",\n              borderRadius: 16,\n              padding: 24,\n              boxShadow: \"0 1px 3px 0 rgba(0, 0, 0, 0.1)\",\n              marginBottom: 80,\n            }}\n          >\n            <div style={{ display: \"flex\", alignItems: \"center\", justifyContent: \"space-between\", marginBottom: 16 }}>\n              <h3 style={{ fontSize: 18, fontWeight: 700, color: \"#1f2937\" }}>{selectedDate}の設定</h3>\n              {selectedDaySchedules.length > 0 && (\n                <button\n                  onClick={() => addNewSchedule(selectedDate)}\n                  style={{\n                    padding: \"8px 16px\",\n                    backgroundColor: \"#3b82f6\",\n                    color: \"white\",\n                    border: \"none\",\n                    borderRadius: 8,\n                    fontSize: 14,\n                    fontWeight: 600,\n                    cursor: \"pointer\",\n                    display: \"flex\",\n                    alignItems: \"center\",\n                    gap: 6,\n                  }}\n                >\n                  <span>+</span>\n                  新しい運行を追加\n                </button>\n              )}\n            </div>\n\n            {selectedDaySchedules.length === 0 ? (\n              <div style={{ textAlign: \"center\", padding: \"40px 20px\", color: \"#6b7280\" }}>\n                <p style={{ fontSize: 16, marginBottom: 12 }}>この日は運行スケジュールが設定されていません</p>\n                <button\n                  onClick={() => addNewSchedule(selectedDate)}\n                  style={{\n                    padding: \"12px 24px\",\n                    backgroundColor: \"#3b82f6\",\n                    color: \"white\",\n                    border: \"none\",\n                    borderRadius: 8,\n                    fontSize: 16,\n                    fontWeight: 600,\n                    cursor: \"pointer\",\n                  }}\n                >\n                  運行予定を追加\n                </button>\n              </div>\n            ) : (\n              selectedDaySchedules.map((schedule, index) => (\n                <div\n                  key={index}\n                  style={{\n                    border: \"1px solid #e5e7eb\",\n                    borderRadius: 12,\n                    padding: 20,\n                    marginBottom: 16,\n                    backgroundColor: \"#f9fafb\",\n                  }}\n                >\n                  <div style={{ display: \"flex\", alignItems: \"center\", justifyContent: \"space-between\", marginBottom: 16 }}>\n                    <h4 style={{ fontSize: 16, fontWeight: 700, color: \"#1f2937\" }}>\n                      運行 {index + 1} {schedule.isOperating ? \"\" : \"(無効)\"}\n                    </h4>\n                    {selectedDaySchedules.length > 1 && (\n                      <button\n                        onClick={() => removeSchedule(selectedDate, index)}\n                        style={{\n                          padding: \"6px 12px\",\n                          backgroundColor: \"#ef4444\",\n                          color: \"white\",\n                          border: \"none\",\n                          borderRadius: 6,\n                          fontSize: 12,\n                          fontWeight: 600,\n                          cursor: \"pointer\",\n                        }}\n                      >\n                        削除\n                      </button>\n                    )}\n                  </div>\n\n                  <div style={{ marginBottom: 16 }}>\n                    <label style={{ display: \"flex\", alignItems: \"center\", cursor: \"pointer\" }}>\n                      <input\n                        type=\"checkbox\"\n                        checked={schedule.isOperating}\n                        onChange={(e) => updateSchedule(selectedDate, index, { isOperating: e.target.checked })}\n                        style={{ width: 20, height: 20, marginRight: 12, cursor: \"pointer\" }}\n                      />\n                      <span style={{ fontSize: 14, fontWeight: 600, color: \"#1f2937\" }}>この運行を有効にする</span>\n                    </label>\n                  </div>\n\n                  {schedule.isOperating && (\n                    <>\n                      <div style={{ marginBottom: 16 }}>\n                        <label style={{ display: \"block\", fontSize: 14, fontWeight: 600, color: \"#374151\", marginBottom: 8 }}>\n                          <Clock size={16} style={{ display: \"inline\", marginRight: 8 }} />\n                          運行時間\n                        </label>\n                        <div style={{ display: \"flex\", alignItems: \"center\", gap: 12 }}>\n                          <input\n                            type=\"time\"\n                            value={schedule.startTime}\n                            onChange={(e) => updateSchedule(selectedDate, index, { startTime: e.target.value })}\n                            style={{\n                              flex: 1,\n                              padding: \"12px 16px\",\n                              border: \"1px solid #d1d5db\",\n                              borderRadius: 8,\n                              fontSize: 16,\n                            }}\n                          />\n                          <span style={{ color: \"#6b7280\" }}>〜</span>\n                          <input\n                            type=\"time\"\n                            value={schedule.endTime}\n                            onChange={(e) => updateSchedule(selectedDate, index, { endTime: e.target.value })}\n                            style={{\n                              flex: 1,\n                              padding: \"12px 16px\",\n                              border: \"1px solid #d1d5db\",\n                              borderRadius: 8,\n                              fontSize: 16,\n                            }}\n                          />\n                        </div>\n                      </div>\n\n                      <div style={{ marginBottom: 16 }}>\n                        <label style={{ display: \"block\", fontSize: 14, fontWeight: 600, color: \"#374151\", marginBottom: 8 }}>\n                          <Route size={16} style={{ display: \"inline\", marginRight: 8 }} />\n                          ルートタイプ\n                        </label>\n                        <div style={{ display: \"flex\", gap: 12 }}>\n                          <button\n                            onClick={() => updateSchedule(selectedDate, index, { routeType: \"循環ルート\" })}\n                            style={{\n                              flex: 1,\n                              padding: \"12px 16px\",\n                              border: schedule.routeType === \"循環ルート\" ? \"2px solid #3b82f6\" : \"1px solid #d1d5db\",\n                              borderRadius: 8,\n                              backgroundColor: schedule.routeType === \"循環ルート\" ? \"#dbeafe\" : \"white\",\n                              cursor: \"pointer\",\n                              fontSize: 16,\n                              fontWeight: 600,\n                              color: schedule.routeType === \"循環ルート\" ? \"#1e40af\" : \"#6b7280\",\n                              transition: \"all 0.2s\",\n                            }}\n                          >\n                            循環ルート\n                          </button>\n                          <button\n                            onClick={() => updateSchedule(selectedDate, index, { routeType: \"フリー運行\" })}\n                            style={{\n                              flex: 1,\n                              padding: \"12px 16px\",\n                              border: schedule.routeType === \"フリー運行\" ? \"2px solid #3b82f6\" : \"1px solid #d1d5db\",\n                              borderRadius: 8,\n                              backgroundColor: schedule.routeType === \"フリー運行\" ? \"#dbeafe\" : \"white\",\n                              cursor: \"pointer\",\n                              fontSize: 16,\n                              fontWeight: 600,\n                              color: schedule.routeType === \"フリー運行\" ? \"#1e40af\" : \"#6b7280\",\n                              transition: \"all 0.2s\",\n                            }}\n                          >\n                            フリー運行\n                          </button>\n                        </div>\n                      </div>\n\n                      {schedule.routeType === \"循環ルート\" && (\n                        <div style={{ marginBottom: 16 }}>\n                          <label\n                            style={{ display: \"block\", fontSize: 14, fontWeight: 600, color: \"#374151\", marginBottom: 8 }}\n                          >\n                            <Route size={16} style={{ display: \"inline\", marginRight: 8 }} />\n                            使用するルート\n                          </label>\n\n                          <div style={{ display: \"flex\", gap: 12 }}>\n                            <button\n                              onClick={() => handleSelectRouteFromMap(index)}\n                              style={{\n                                flex: 1,\n                                padding: \"16px 20px\",\n                                border: \"2px dashed #3b82f6\",\n                                borderRadius: 12,\n                                backgroundColor: \"white\",\n                                cursor: \"pointer\",\n                                fontSize: 16,\n                                fontWeight: 600,\n                                color: \"#3b82f6\",\n                                display: \"flex\",\n                                alignItems: \"center\",\n                                justifyContent: \"center\",\n                                gap: 8,\n                                transition: \"all 0.2s\",\n                              }}\n                            >\n                              <MapPin size={20} />\n                              地図でルートを選択\n                            </button>\n                          </div>\n\n                          {schedule.routeId && (\n                            <div\n                              style={{\n                                marginTop: 12,\n                                padding: \"12px 16px\",\n                                backgroundColor: \"#dbeafe\",\n                                borderRadius: 8,\n                                border: \"1px solid #3b82f6\",\n                                display: \"flex\",\n                                alignItems: \"center\",\n                                justifyContent: \"space-between\",\n                              }}\n                            >\n                              <div>\n                                <div style={{ fontSize: 12, color: \"#6b7280\", marginBottom: 4 }}>選択中のルート</div>\n                                <div style={{ fontSize: 16, fontWeight: 700, color: \"#1e40af\" }}>{schedule.routeId}</div>\n                              </div>\n                              <button\n                                onClick={() => updateSchedule(selectedDate, index, { routeId: undefined })}\n                                style={{\n                                  padding: \"6px 12px\",\n                                  backgroundColor: \"white\",\n                                  border: \"1px solid #d1d5db\",\n                                  borderRadius: 6,\n                                  fontSize: 12,\n                                  color: \"#6b7280\",\n                                  cursor: \"pointer\",\n                                }}\n                              >\n                                解除\n                              </button>\n                            </div>\n                          )}\n                        </div>\n                      )}\n\n                      <div style={{ marginBottom: 0 }}>\n                        <label style={{ display: \"block\", fontSize: 14, fontWeight: 600, color: \"#374151\", marginBottom: 8 }}>\n                          <MapPin size={16} style={{ display: \"inline\", marginRight: 8 }} />\n                          スタート地点\n                        </label>\n                        <input\n                          type=\"text\"\n                          value={schedule.startLocation || \"\"}\n                          onChange={(e) => updateSchedule(selectedDate, index, { startLocation: e.target.value })}\n                          placeholder=\"例：ヤンマー前\"\n                          style={{\n                            width: \"100%\",\n                            padding: \"12px 16px\",\n                            border: \"1px solid #d1d5db\",\n                            borderRadius: 8,\n                            fontSize: 16,\n                            boxSizing: \"border-box\",\n                          }}\n                        />\n                      </div>\n                    </>\n                  )}\n                </div>\n              ))\n            )}\n          </div>\n        )}\n\n        <div\n          style={{\n            backgroundColor: \"white\",\n            borderRadius: 16,\n            padding: 16,\n            boxShadow: \"0 1px 3px 0 rgba(0, 0, 0, 0.1)\",\n            marginBottom: 16,\n          }}\n        >\n          <button\n            onClick={handleSaveSchedule}\n            disabled={saving}\n            style={{\n              width: \"100%\",\n              padding: \"16px 24px\",\n              backgroundColor: saving ? \"#9ca3af\" : \"#10b981\",\n              color: \"white\",\n              border: \"none\",\n              borderRadius: 12,\n              fontSize: 16,\n              fontWeight: 700,\n              cursor: saving ? \"not-allowed\" : \"pointer\",\n              display: \"flex\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n              gap: 8,\n              transition: \"all 0.2s\",\n            }}\n          >\n            <Save size={20} />\n            {saving ? \"保存中...\" : \"スケジュールを保存\"}\n          </button>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}