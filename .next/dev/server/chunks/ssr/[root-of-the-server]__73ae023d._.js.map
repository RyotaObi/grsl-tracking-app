{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/admin/Documents/my-app/app/page.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { useEffect, useState, useCallback } from \"react\"\r\nimport { MapWrapper } from \"@/components/map-wrapper\"\r\nimport { ZoomControls } from \"@/components/zoom-controls\"\r\nimport { PassengerCount } from \"@/components/passenger-count\"\r\nimport { RouteInfo } from \"@/components/route-info\"\r\nimport { getRealtimeLocations } from \"@/lib/firebase\"\r\nimport type { LocationData } from \"@/lib/types\"\r\nimport type { Map as LeafletMap } from \"leaflet\"\r\n\r\nexport default function Home() {\r\n  const [locations, setLocations] = useState<LocationData[]>([])\r\n  const [map, setMap] = useState<LeafletMap | null>(null)\r\n  const [collectionName, setCollectionName] = useState<string>(\"\")\r\n\r\n  // 今日の日付からコレクション名を生成\r\n  useEffect(() => {\r\n    const today = new Date()\r\n    const year = today.getFullYear()\r\n    const month = String(today.getMonth() + 1).padStart(2, \"0\")\r\n    const day = String(today.getDate()).padStart(2, \"0\")\r\n    const todayCollection = `${year}${month}${day}`\r\n    setCollectionName(todayCollection)\r\n  }, [])\r\n\r\n  // Firestoreからリアルタイムでデータを取得\r\n  useEffect(() => {\r\n    if (!collectionName) return\r\n\r\n    console.log(\"[v0] Subscribing to collection:\", collectionName)\r\n\r\n    const unsubscribe = getRealtimeLocations(collectionName, (newLocations) => {\r\n      console.log(\"[v0] Received locations:\", newLocations.length)\r\n      setLocations(newLocations)\r\n    })\r\n\r\n    return () => {\r\n      console.log(\"[v0] Unsubscribing from collection\")\r\n      unsubscribe()\r\n    }\r\n  }, [collectionName])\r\n\r\n  // ユーザーの現在位置を中心に\r\n  const handleUserLocation = useCallback(() => {\r\n    if (!map) return\r\n\r\n    if (\"geolocation\" in navigator) {\r\n      navigator.geolocation.getCurrentPosition(\r\n        (position) => {\r\n          map.setView([position.coords.latitude, position.coords.longitude], 15)\r\n        },\r\n        (error) => {\r\n          console.error(\"[v0] Geolocation error:\", error)\r\n          alert(\"位置情報の取得に失敗しました\")\r\n        },\r\n      )\r\n    } else {\r\n      alert(\"このブラウザは位置情報に対応していません\")\r\n    }\r\n  }, [map])\r\n\r\n  // 車両の現在位置を中心に\r\n  const handleVehicleLocation = useCallback(() => {\r\n    if (!map || locations.length === 0) return\r\n\r\n    const latestLocation = locations[locations.length - 1]\r\n    map.setView([latestLocation.latitude, latestLocation.longitude], 15)\r\n  }, [map, locations])\r\n\r\n  // サンプルの予定ルート（実際のデータに置き換えてください）\r\n  const plannedRoute: [number, number][] = [\r\n    [35.6812, 139.7671],\r\n    [35.6897, 139.6917],\r\n    [35.6762, 139.6503],\r\n  ]\r\n\r\n  return (\r\n    <main className=\"w-full h-screen relative\">\r\n      <MapWrapper locations={locations} plannedRoute={plannedRoute} onMapReady={setMap} />\r\n      <ZoomControls map={map} onUserLocation={handleUserLocation} onVehicleLocation={handleVehicleLocation} />\r\n      <PassengerCount />\r\n      <RouteInfo routeName=\"ブルールート走行中\" />\r\n    </main>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;;;;;;;;;;;;;;;;;;;;;;;;;;AAFA;;;;;;;;AAWe,SAAS;IACtB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAiB,EAAE;IAC7D,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,iNAAQ,EAAoB;IAClD,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,iNAAQ,EAAS;IAE7D,oBAAoB;IACpB,IAAA,kNAAS,EAAC;QACR,MAAM,QAAQ,IAAI;QAClB,MAAM,OAAO,MAAM,WAAW;QAC9B,MAAM,QAAQ,OAAO,MAAM,QAAQ,KAAK,GAAG,QAAQ,CAAC,GAAG;QACvD,MAAM,MAAM,OAAO,MAAM,OAAO,IAAI,QAAQ,CAAC,GAAG;QAChD,MAAM,kBAAkB,GAAG,OAAO,QAAQ,KAAK;QAC/C,kBAAkB;IACpB,GAAG,EAAE;IAEL,2BAA2B;IAC3B,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,gBAAgB;QAErB,QAAQ,GAAG,CAAC,mCAAmC;QAE/C,MAAM,cAAc,qBAAqB,gBAAgB,CAAC;YACxD,QAAQ,GAAG,CAAC,4BAA4B,aAAa,MAAM;YAC3D,aAAa;QACf;QAEA,OAAO;YACL,QAAQ,GAAG,CAAC;YACZ;QACF;IACF,GAAG;QAAC;KAAe;IAEnB,gBAAgB;IAChB,MAAM,qBAAqB,IAAA,oNAAW,EAAC;QACrC,IAAI,CAAC,KAAK;QAEV,IAAI,iBAAiB,WAAW;YAC9B,UAAU,WAAW,CAAC,kBAAkB,CACtC,CAAC;gBACC,IAAI,OAAO,CAAC;oBAAC,SAAS,MAAM,CAAC,QAAQ;oBAAE,SAAS,MAAM,CAAC,SAAS;iBAAC,EAAE;YACrE,GACA,CAAC;gBACC,QAAQ,KAAK,CAAC,2BAA2B;gBACzC,MAAM;YACR;QAEJ,OAAO;YACL,MAAM;QACR;IACF,GAAG;QAAC;KAAI;IAER,cAAc;IACd,MAAM,wBAAwB,IAAA,oNAAW,EAAC;QACxC,IAAI,CAAC,OAAO,UAAU,MAAM,KAAK,GAAG;QAEpC,MAAM,iBAAiB,SAAS,CAAC,UAAU,MAAM,GAAG,EAAE;QACtD,IAAI,OAAO,CAAC;YAAC,eAAe,QAAQ;YAAE,eAAe,SAAS;SAAC,EAAE;IACnE,GAAG;QAAC;QAAK;KAAU;IAEnB,+BAA+B;IAC/B,MAAM,eAAmC;QACvC;YAAC;YAAS;SAAS;QACnB;YAAC;YAAS;SAAS;QACnB;YAAC;YAAS;SAAS;KACpB;IAED,qBACE,8OAAC;QAAK,WAAU;;0BACd,8OAAC;gBAAW,WAAW;gBAAW,cAAc;gBAAc,YAAY;;;;;;0BAC1E,8OAAC;gBAAa,KAAK;gBAAK,gBAAgB;gBAAoB,mBAAmB;;;;;;0BAC/E,8OAAC;;;;;0BACD,8OAAC;gBAAU,WAAU;;;;;;;;;;;;AAG3B","debugId":null}},
    {"offset": {"line": 167, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/admin/Documents/my-app/node_modules/next/src/server/route-modules/app-page/module.compiled.js"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK"],"mappings":"AAAA,IAAIA,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;KAElC;IACL,IAAIF,QAAQC,GAAG,CAACK,yBAAyB,EAAE;;SAcpC;QACL,IAAIN,QAAQC,GAAG,CAACM,QAAQ,KAAK,WAAe;YAC1C,IAAIP,QAAQC,GAAG,CAACO,SAAS,eAAE;gBACzBL,OAAOC,OAAO,GAAGC,QAAQ;YAC3B,OAAO;;QAGT,OAAO;;IAOT;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 186, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/admin/Documents/my-app/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,kBAAkB","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 191, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/admin/Documents/my-app/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n"],"names":["module","exports","require","vendored","React"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,KAAK","ignoreList":[0],"debugId":null}}]
}